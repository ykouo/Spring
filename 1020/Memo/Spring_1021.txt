ìŠ¤í”„ë§ì—ì„œ ì œê³µí•˜ëŠ” DSë¡œ DSë¥¼ êµì²´!

ìŠ¤í”„ë§ì—ì„œ ì œê³µí•˜ëŠ” DSë¥¼ ì‚¬ìš© 
ğŸ‘‰ğŸ» login.do -> DSê°ì²´ ìƒì„± -> init() ìë™í˜¸ì¶œ  ğŸ‘ˆğŸ» ì—¬ê¸°ì„œ HandlerMapping...ë“±ì´ ë§Œë“¤ì–´ì§„ë‹¤.
	-> initì´ ì™„ë£Œê°€ë˜ë©´ XmlWebApplicationContext ê°€ ìƒì„±ë¨
	

fileNotFoundException ë°œìƒ 
-> ì´ìœ  : ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆë¥¼ ë³€ê²½í•˜ë©´ í•´ë‹¹ ì»¨í…Œì´ë„ˆì˜ xmlíŒŒì¼ì„ ë¨¼ì € ë³´ê²Œ ë˜ëŠ”ë° Springì»¨í…Œì´ë„ˆì˜ DispatcherServletì„ ì‚¬ìš©í•˜ê¸°ë¡œ 
		 web.xmlì—ì„œ ì§€ì •í•˜ì˜€ë‹¤. 


âœ” ì •í™•í•œ ìœ„ì¹˜ì™€ ì´ë¦„ í˜•ì‹ì„ ì§€ì •í•´ì•¼í•œë‹¤. 
[/WED-INF/ë“±ë¡í•œ ì„œë¸”ë¦¿ ì´ë¦„-servlet.xml]


==> controller.DispatcherServletì´ í•„ìš”ê°€ ì—†ì–´ì§ 


Controller ë³€ê²½
Controller : ìš°ë¦¬ê°€ ë§Œë“ ê±° 
ActionForward, execute(req,res)ë¡œ êµ¬ì„±ë˜ì–´ìˆë˜ ì»¨íŠ¸ë¡¤ëŸ¬
--> String, execute(req,res) -> ê²½ë¡œ / ë¡œ ë³€ê²½ë˜ì—ˆì—ˆë‹¤.
--> Controller : Springì—ì„œ ì œê³µ
 	ModelAndView handleRequest()
	â†’ mavê°ì²´ ë¦¬í„´ : ì •ë³´ì™€ ê²½ë¡œë¥¼ ì €ì¥í•´ ë¦¬í„´í• ìˆ˜ ìˆë‹¤. 
	
DS -> C -> mavê°ì²´ë¥¼ ë¦¬í„´ -> Modelì— ì €ì¥ëœ ì •ë³´ ì¶”ì¶œ -> Viewì— ì €ì¥ëœ ê³³ìœ¼ë¡œ ì „ì†¡
-							-> â˜…  ìš°ë¦¬ëŠ” ì „ì†¡í—¤ë”ë¼ëŠ” ê°œë…ì„ ì‚¬ìš©í•˜ëŠ”ë°  í—¤ë”ì— ë°ì´í„°ë¥¼ ë„£ì–´ì„œ ë³´ë‚¼ë•Œ
								 HttpServletRequest Model ê°ì²´ì— ì •ë³´ë¥¼ ì €ì¥í•´ì„œ ë³´ëƒ„
								 ==> Sessionì´ë‚˜ Applicationì— ë‹´ì•„ì„œ ë³´ë‚´ë©´ ì•ˆë˜ëƒëŠ” ì§ˆë¬¸ì´ å¤š: ì„œë²„ ë¶€ë‹´ì´ ë¨

web.xml ì„¤ì •ì„ ë°”ê¿”ì¤˜ì•¼í•œë‹¤.
====================================================================================
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee https://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" version="2.5">
  <servlet>
    <description></description>
    <display-name>DispatcherServlet</display-name>
    <servlet-name>DispatcherServlet</servlet-name>
    <servlet-class>controller.common.DispatcherServlet</servlet-class> ğŸ‘ˆğŸ» org.springframework.web.servlet.DispatcherServlet
  </servlet>
  <servlet-mapping>
    <servlet-name>DispatcherServlet</servlet-name>
    <url-pattern>*.do</url-pattern>
  </servlet-mapping>
  <context-param>
    <param-name>encoding</param-name>
    <param-value>UTF-8</param-value>
  </context-param>
  <filter>
    <display-name>EncFilter</display-name>
    <filter-name>EncFilter</filter-name>
    <filter-class>controller.common.EncFilter</filter-class> ğŸ‘ˆğŸ»  org.springframework.web.filter.CharacterEncodingFilter
 	******************* ì¶”ê°€ 
 	<init-param>
       <param-name>encoding</param-name>
       <param-value>UTF-8</param-value>
    </init-param>
 	*******************
  </filter>
  <filter-mapping>
    <filter-name>EncFilter</filter-name>
    <url-pattern>*.do</url-pattern>
  </filter-mapping>
  <filter-mapping>
    <filter-name>EncFilter</filter-name>
    <url-pattern>*.jsp</url-pattern>
  </filter-mapping>
</web-app>
====================================================================================






































package controller.common;

import java.io.IOException;


import javax.servlet.ServletException;

import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;


// DispatcherServlet == FrontController

/**
 * Servlet implementation class DispatcherServlet
 */
public class DispatcherServlet extends HttpServlet {
	private static final long serialVersionUID = 1L;
    // ì¶”ê°€ 
	private HandlerMapping handlerMapping;
	private ViewResolver viewResolver;
	
	// ë¡œê·¸ì¸ì˜ ê²½ìš° LoginController ê°ì²´ëŠ” í•˜ë‚˜ë§Œ ìˆì–´ë„ ê´œì°®ìŒ
	// ì´ˆê¸°í™” ë©”ì„œë“œë¥¼ ìƒì„±
	public void init() {
		handlerMapping = new HandlerMapping();
		viewResolver = new ViewResolver();
		viewResolver.setPrefix("./"); // í˜„ì¬ë””ë ‰í† ë¦¬
		viewResolver.setSuffix(".jsp"); // íŒŒì¼íƒ€ì…
	}
	
    /**
     * @see HttpServlet#HttpServlet()
     */
    public DispatcherServlet() {
        super();
        // TODO Auto-generated constructor stub
    }

	/**
	 * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)
	 */
	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		// TODO Auto-generated method stub
		doAction(request,response);
	}

	/**
	 * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)
	 */
	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		// TODO Auto-generated method stub
		doAction(request,response);
	}
	
	private void doAction(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		String uri = request.getRequestURI();
		String cp = request.getContextPath();
		String action = uri.substring(cp.length());	
	
		// HandlerMappingì—ê²Œ actionê°’ì„ ì „ë‹¬, Controllerê°ì²´ë¥¼ ë°˜í™˜ë°›ëŠ”ë‹¤. 
		// ==> Lookup(ê²€ìƒ‰, íƒìƒ‰)í•œë‹¤ == ê°ì²´ë¥¼ ì°¾ì•„ë‹¤ë‹ˆëŠ” í–‰ìœ„ 
		
		Controller controller = handlerMapping.getController(action);
		
		// í´ë¼ì´ì–¸íŠ¸ì˜  ìš”ì²­ì„ ì‹¤ì§ˆì ìœ¼ë¡œ ìˆ˜í–‰í•˜ëŠ” controller ê°ì²´!!!
		// ê·¸ ê²°ê³¼ë¡œ "ê²½ë¡œ"ë¥¼ ë¦¬í„´!!
		String view = controller.execute(request, response); // ë™ì ë°”ì¸ë”©ì´ ì¼ì–´ë‚¬ë‹¤! == ë‹¤í˜•ì„± ì ìš© ëë‹¤!
		
		if(!view.contains(".do")){
			view = viewResolver.getView(view);
		}
		
		response.sendRedirect(view);
			
	}

}
